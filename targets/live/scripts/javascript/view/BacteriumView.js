(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define(["lodash","backbone","Config"],function(e,r,i){var s;return s=function(r){function s(){return s.__super__.constructor.apply(this,arguments)}return t(s,r),s.prototype.initialize=function(){return this.buid=this.model.get("buid"),this.clanid=this.model.get("clanid"),this.glow=!1,this.removeGlowOnNext=!1},s.prototype.render=function(e){var t;return this.paper=e,t=this.model.get("position"),this.self=this.paper.circle(t.x,t.y,this.model.get("radius")),this.colorSelf()},s.prototype.colorSelf=function(){var e;return e=this.getColor(),this.self.attr("fill",e),this.self.attr("stroke",i.Stroke)},s.prototype.getColor=function(){var t,r;t=i.Colors.clanid[this.clanid];if(!t){if(i.Colors.used.length===i.Colors.choices.length)return console.log("ERROR: too many clans! Add colors"),"#000000";for(;;){r=e.random(1,i.Colors.choices.length)-1,t=i.Colors.choices[r];if(n.call(i.Colors.used,t)<0)break}i.Colors.clanid[this.clanid]=t,i.Colors.used.push(t)}return t},s.prototype.kill=function(){return this.self.remove()},s.prototype.move=function(){var e,t;e=this.model.get("position"),t=this.model.get("radius"),this.self.attr("cx",e.x),this.self.attr("cy",e.y),window.count=window.count||1,window.count=window.count+1,this.self.attr("r",t);if(this.glow)return this.removeGlow(),this.removeGlowOnNext?(console.log("bam"),this.glow=!1,this.removeGlowOnNext=!1):this.addGlow()},s.prototype.removeGlow=function(){if(this.glow)return this.glow.forEach(function(e){return e.remove()})},s.prototype.removeGlowPermanently=function(){return this.removeGlowOnNext=!0},s.prototype.addGlow=function(){return this.glow=this.self.glow({color:"#e238a7"})},s.prototype.addListener=function(e){return this.self.click(e)},s}(r.View)})}).call(this)