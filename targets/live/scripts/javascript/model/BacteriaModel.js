(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["backbone","lodash","Config","BacteriumModel","BacteriumCollection"],function(e,n,r,i,s){var o;return o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.initialize=function(e){var t=this;return this.population=e,this.buid=0,this.bacteria=new s,this.bacteria.on("add",function(e){return t.mediator.bacteriumModelAdded(e)}),this.bacteria.on("change:position",function(e){return t.mediator.bacteriumMoved(e)}),this.bacteria.on("change:radius",function(e){return t.mediator.bacteriumMoved(e)})},o.prototype.addMediator=function(e){this.mediator=e},o.prototype.addPopulation=function(e,t){var n,r,i;i=[];for(n=r=1;r<=e;n=r+=1)i.push(this.addBacterium(t));return i},o.prototype.addBacterium=function(e){var t,s,o,u,a,f,l;s=r,u=s.Bacterium.radius.min,o=s.Bacterium.radius.max;for(;;){f=n.random(u,o),a={},a.x=n.random(0+f,s.BoardWidth-f),a.y=n.random(0+f,s.BoardHeight-f);if(this.noCollision(a,f))break}return l=n.random(s.Bacterium.velocity.min,s.Bacterium.velocity.max),t=new i(this.getBuid(),e,a,f,l,this),this.bacteria.add(t)},o.prototype.bacterialPredation=function(e,t){var n,r,i,s,o,u,a,f;return s=Math.PI,o=Math.pow,this.bacteria.remove(t),this.mediator.kill(t),u=e.get("radius"),a=t.get("radius"),n=s*o(u,2),r=s*o(a,2),f=n+r,i=Math.sqrt(f/Math.PI),e.set({radius:i})},o.prototype.removeBacterium=function(e){return this.bacteria.remove(e)},o.prototype.noCollision=function(e,t){var n;return n=!1,this.bacteria.forEach(function(r){if(r.collidesWith(e,t))return n=!0}),!n},o.prototype.bacterialCollision=function(e){var t;return t=!1,this.bacteria.forEach(function(n){if(n!==e&&n.collidesWithBacterium(e))return t=n}),t},o.prototype.bumpsSomething=function(e){var t,n,r;return n=!1,r={},t=this.bumpsWall(e),!1===t?(n=this.bacterialCollision(e),n&&(r.obstacle="bacterium",r.bacterium=n)):(n=!0,r.obstacle="wall",r.direction=t),n?r:!1},o.prototype.bumpsWall=function(e){var t,n,i;return t=!1,n=e.get("position"),i=e.get("radius"),n.x-i<0&&(t="left"),n.y-i<0&&(t="top"),n.x+i>r.BoardWidth&&(t="right"),n.y+i>r.BoardHeight&&(t="bottom"),t},o.prototype.getBuid=function(){return++this.buid},o.prototype.move=function(){var e=this;return setInterval(function(){return e.bacteria.forEach(function(e){if(e)return e.update()}),e.mediator.tick()},r.Bacterium.tick)},o}(e.Model)})}).call(this)